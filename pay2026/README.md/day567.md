## `glm6.py` Python çŸ¥è¯†ç‚¹æ€»ç»“

### ä¸€ã€æ¨¡å—å¯¼å…¥

#### 1. **æ ‡å‡†æ¨¡å—å¯¼å…¥**
```1:3:glm6.py
import requests
import json
import textwrap
```
- `import` å¯¼å…¥æ•´ä¸ªæ¨¡å—
- `requests`ï¼šHTTP è¯·æ±‚åº“
- `json`ï¼šJSON æ•°æ®å¤„ç†
- `textwrap`ï¼šæ–‡æœ¬æ ¼å¼åŒ–å·¥å…·

#### 2. **ä»æ¨¡å—å¯¼å…¥ç‰¹å®šå¯¹è±¡**
```5:6:glm6.py
from requests.utils import stream_decode_response_unicode
from xunfei_tts import text_to_speech
```
- `from ... import ...` å¯¼å…¥ç‰¹å®šå‡½æ•°æˆ–ç±»
- ä»æ ‡å‡†åº“å­æ¨¡å—å¯¼å…¥
- ä»è‡ªå®šä¹‰æ¨¡å—å¯¼å…¥

#### 3. **æ¨¡å—å¯¼å…¥ä½ç½®**
```31:31:glm6.py
import random
```
- å¯åœ¨å‡½æ•°å¤–éƒ¨æˆ–å†…éƒ¨å¯¼å…¥
- å»ºè®®åœ¨æ–‡ä»¶é¡¶éƒ¨ç»Ÿä¸€å¯¼å…¥

---

### äºŒã€å‡½æ•°å®šä¹‰

#### 4. **å‡½æ•°å®šä¹‰ä¸å‚æ•°**
```8:8:glm6.py
def call_zhipu_api(messages, model="glm-4-flash"):
```
- `def` å®šä¹‰å‡½æ•°
- å¿…éœ€å‚æ•°ï¼š`messages`
- é»˜è®¤å‚æ•°ï¼š`model="glm-4-flash"`

#### 5. **å‡½æ•°è¿”å›å€¼**
```25:25:glm6.py
return response.json()
```
- `return` è¿”å›æ•°æ®
- å¯è¿”å›å­—å…¸ã€åˆ—è¡¨ç­‰

#### 6. **ä¸»å‡½æ•°å®šä¹‰**
```78:78:glm6.py
def main():
```
- å®šä¹‰ä¸»å‡½æ•°ï¼Œç»„ç»‡ç¨‹åºå…¥å£

---

### ä¸‰ã€æ•°æ®ç»“æ„

#### 7. **å­—å…¸ (Dictionary)**
```11:14:glm6.py
headers = {
    "Authorization": "85556a78acba4b4eb7a5130fa9139580.uMmcFvwz4LGabgRQ",
    "Content-Type": "application/json"
}
```

```16:20:glm6.py
data = {
    "model": model,
    "messages": messages,
    "temperature": 0.3
}
```
- ä½¿ç”¨ `{}` åˆ›å»ºå­—å…¸
- é”®å€¼å¯¹ç»“æ„
- å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ã€å˜é‡ã€åˆ—è¡¨

#### 8. **åˆ—è¡¨ (List)**
```33:62:glm6.py
words = [
    {
        "keyword": "å’–å•¡æœº",
        "clues": [
            "æˆ‘æ¯å¤©æ¸…æ™¨éƒ½ä¼šå‘å‡ºå’•å˜Ÿå£°ã€‚",
            ...
        ]
    },
    ...
]
```
- ä½¿ç”¨ `[]` åˆ›å»ºåˆ—è¡¨
- åˆ—è¡¨å¯åŒ…å«å­—å…¸
- æ”¯æŒåµŒå¥—ç»“æ„

#### 9. **åµŒå¥—æ•°æ®ç»“æ„**
- åˆ—è¡¨åŒ…å«å­—å…¸ï¼š`[{...}, {...}]`
- å­—å…¸å€¼å¯ä»¥æ˜¯åˆ—è¡¨ï¼š`{"clues": [...]}`
- å¤šå±‚åµŒå¥—è®¿é—®

---

### å››ã€å­—ç¬¦ä¸²æ“ä½œ

#### 10. **å­—ç¬¦ä¸²å­—é¢é‡**
```9:9:glm6.py
url = "https://open.bigmodel.cn/api/paas/v4/chat/completions"
```
- ä½¿ç”¨å¼•å·å®šä¹‰å­—ç¬¦ä¸²
- å­˜å‚¨ URLã€æ–‡æœ¬ç­‰

#### 11. **f-string æ ¼å¼åŒ–å­—ç¬¦ä¸²**
```27:27:glm6.py
raise Exception(f"APIè°ƒç”¨å¤±è´¥: {response.status_code}, {response.text}")
```

```65:76:glm6.py
system_prompt = textwrap.dedent(f"""
ä½ æ˜¯ä¸€ä¸ª"è°œè¯­äºº"ã€‚å½“å‰è¦ç©å®¶çŒœçš„åè¯æ˜¯ï¼š{target["keyword"]}ã€‚
...
""")
```

```84:84:glm6.py
question = input(f"\nç¬¬ {round_id} å›åˆï¼Œä½ çš„é—®é¢˜æˆ–çŒœæµ‹ï¼Œå¦‚æœä½ çŒœåˆ°äº†è¯·ç›´æ¥è¾“å…¥è¿™ä¸ªåè¯ï¼š")
```

```91:91:glm6.py
print(f"è°œè¯­äººï¼š{answer}")
```
- `f"..."` æ ¼å¼åŒ–å­—ç¬¦ä¸²
- ä½¿ç”¨ `{å˜é‡å}` åµŒå…¥å˜é‡
- æ”¯æŒè¡¨è¾¾å¼å’Œå­—å…¸è®¿é—®

#### 12. **textwrap.dedent() æ–¹æ³•**
```65:65:glm6.py
system_prompt = textwrap.dedent
```
- å»é™¤å¤šè¡Œå­—ç¬¦ä¸²çš„ç¼©è¿›
- ä¿æŒä»£ç æ ¼å¼æ•´æ´

#### 13. **å­—ç¬¦ä¸²æ–¹æ³•**
```93:93:glm6.py
user_guess = question.strip().replace(" ", "")
```
- `strip()`ï¼šå»é™¤é¦–å°¾ç©ºç™½
- `replace()`ï¼šæ›¿æ¢å­—ç¬¦
- æ–¹æ³•é“¾å¼è°ƒç”¨

#### 14. **å­—ç¬¦ä¸²æˆå‘˜æ£€æŸ¥**
```98:98:glm6.py
if "æ­å–œä½ çŒœåˆ°å•¦" in answer or target["keyword"] in answer:
```
- `in` è¿ç®—ç¬¦æ£€æŸ¥å­ä¸²
- è¿”å›å¸ƒå°”å€¼

---

### äº”ã€æ§åˆ¶æµè¯­å¥

#### 15. **æ¡ä»¶è¯­å¥ (if-else)**
```24:27:glm6.py
if response.status_code == 200:
    return response.json()
else:
    raise Exception(f"APIè°ƒç”¨å¤±è´¥: {response.status_code}, {response.text}")
```

```94:96:glm6.py
if user_guess == target["keyword"]:
    print(f"\nğŸ‰ ä½ æå‰çŒœä¸­äº†ï¼ç­”æ¡ˆå°±æ˜¯ {target['keyword']}")
    break
```

```98:100:glm6.py
if "æ­å–œä½ çŒœåˆ°å•¦" in answer or target["keyword"] in answer:
    print("\nğŸ‰ ä½ èµ¢äº†ï¼")
    break
```
- `if...else` æ¡ä»¶åˆ¤æ–­
- `==` æ¯”è¾ƒè¿ç®—ç¬¦
- `or` é€»è¾‘è¿ç®—ç¬¦
- æ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒä»£ç 

#### 16. **for å¾ªç¯**
```83:100:glm6.py
for round_id in range(1, max_rounds + 1):
    question = input(...)
    ...
    if ...:
        break
```
- `for ... in range()` éå†æ•°å­—åºåˆ—
- `range(1, max_rounds + 1)` ç”Ÿæˆ 1 åˆ° max_rounds çš„åºåˆ—

#### 17. **for-else è¯­å¥**
```83:102:glm6.py
for round_id in range(1, max_rounds + 1):
    ...
else:
    print(f"\nğŸ¤” å›åˆç»“æŸï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š{target['keyword']}")
```
- `for...else`ï¼šå¾ªç¯æ­£å¸¸ç»“æŸï¼ˆæœª breakï¼‰æ—¶æ‰§è¡Œ else å—

#### 18. **break è¯­å¥**
```96:96:glm6.py
break
```

```100:100:glm6.py
break
```
- è·³å‡ºå¾ªç¯
- ä¸ `for` æˆ– `while` é…åˆä½¿ç”¨

---

### å…­ã€è¾“å…¥è¾“å‡º

#### 19. **input() å‡½æ•°**
```84:84:glm6.py
question = input(f"\nç¬¬ {round_id} å›åˆï¼Œä½ çš„é—®é¢˜æˆ–çŒœæµ‹ï¼Œå¦‚æœä½ çŒœåˆ°äº†è¯·ç›´æ¥è¾“å…¥è¿™ä¸ªåè¯ï¼š")
```
- ä»æ§åˆ¶å°è¯»å–ç”¨æˆ·è¾“å…¥
- è¿”å›å­—ç¬¦ä¸²ç±»å‹
- å¯æ˜¾ç¤ºæç¤ºä¿¡æ¯

#### 20. **print() å‡½æ•°**
```80:81:glm6.py
print("=== çŒœè¯æ¸¸æˆ ===")
print("æˆ‘å¿ƒé‡Œæƒ³äº†ä¸€ä¸ªæ—¥å¸¸åè¯ï¼Œä¸€å…±æœ‰ 5 å›åˆæ¥çŒœã€‚æ¯å›åˆå¯ä»¥é—®æˆ‘ä¸€ä¸ªé—®é¢˜æˆ–ç›´æ¥çŒœè¯ã€‚")
```

```91:91:glm6.py
print(f"è°œè¯­äººï¼š{answer}")
```
- è¾“å‡ºå†…å®¹åˆ°æ§åˆ¶å°
- å¯è¾“å‡ºå­—ç¬¦ä¸²ã€å˜é‡ã€è¡¨è¾¾å¼ç»“æœ

---

### ä¸ƒã€å‡½æ•°è°ƒç”¨

#### 21. **æ¨¡å—å‡½æ•°è°ƒç”¨**
```22:22:glm6.py
response = requests.post(url, headers=headers, json=data)
```

```25:25:glm6.py
return response.json()
```

```64:64:glm6.py
target = random.choice(words)
```

```65:65:glm6.py
system_prompt = textwrap.dedent
```

```92:92:glm6.py
text_to_speech(f"è°œè¯­äººï¼š{answer}")
```
- è°ƒç”¨æ¨¡å—å‡½æ•°ï¼š`requests.post()`
- è°ƒç”¨å¯¹è±¡æ–¹æ³•ï¼š`response.json()`
- è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°ï¼š`call_zhipu_api()`, `text_to_speech()`
- ä½¿ç”¨å…³é”®å­—å‚æ•°ä¼ é€’å‚æ•°

#### 22. **å…³é”®å­—å‚æ•°**
```22:22:glm6.py
response = requests.post(url, headers=headers, json=data)
```
- ä½¿ç”¨å‚æ•°åä¼ é€’ï¼š`headers=headers`, `json=data`
- æé«˜ä»£ç å¯è¯»æ€§

---

### å…«ã€å¼‚å¸¸å¤„ç†

#### 23. **å¼‚å¸¸æŠ›å‡º**
```27:27:glm6.py
raise Exception(f"APIè°ƒç”¨å¤±è´¥: {response.status_code}, {response.text}")
```
- `raise` æŠ›å‡ºå¼‚å¸¸
- `Exception` å¼‚å¸¸ç±»
- ç”¨äºé”™è¯¯å¤„ç†

---

### ä¹ã€æ•°æ®è®¿é—®

#### 24. **å­—å…¸å’Œåˆ—è¡¨çš„è®¿é—®**
```90:90:glm6.py
answer = result["choices"][0]["message"]["content"]
```

```66:66:glm6.py
ä½ æ˜¯ä¸€ä¸ª"è°œè¯­äºº"ã€‚å½“å‰è¦ç©å®¶çŒœçš„åè¯æ˜¯ï¼š{target["keyword"]}ã€‚
```

```75:75:glm6.py
{target["clues"]}
```
- å­—å…¸è®¿é—®ï¼š`dict['key']`
- åˆ—è¡¨è®¿é—®ï¼š`list[index]`
- é“¾å¼è®¿é—®ï¼š`result["choices"][0]["message"]["content"]`
- åœ¨ f-string ä¸­ä½¿ç”¨å­—å…¸è®¿é—®

#### 25. **å¯¹è±¡æ–¹æ³•è°ƒç”¨**
```25:25:glm6.py
return response.json()
```
- å¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼š`response.json()`
- å°†å“åº”å¯¹è±¡è½¬æ¢ä¸º JSON å­—å…¸

---

### åã€éšæœºé€‰æ‹©

#### 26. **random.choice() å‡½æ•°**
```64:64:glm6.py
target = random.choice(words)
```
- ä»åˆ—è¡¨ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ 
- è¿”å›é€‰ä¸­çš„å­—å…¸å¯¹è±¡

---

### åä¸€ã€å˜é‡èµ‹å€¼

#### 27. **å˜é‡èµ‹å€¼**
```9:9:glm6.py
url = "https://open.bigmodel.cn/api/paas/v4/chat/completions"
```

```79:79:glm6.py
max_rounds = 5
```

```64:64:glm6.py
target = random.choice(words)
```
- ä½¿ç”¨ `=` èµ‹å€¼
- å­—ç¬¦ä¸²å˜é‡èµ‹å€¼
- ä»å‡½æ•°è¿”å›å€¼èµ‹å€¼
- æ•°å­—å˜é‡èµ‹å€¼

---

### åäºŒã€ç¨‹åºå…¥å£

#### 28. **if __name__ == "__main__"**
```104:105:glm6.py
if __name__ == "__main__":
    main()
```
- åˆ¤æ–­æ˜¯å¦ä½œä¸ºä¸»ç¨‹åºè¿è¡Œ
- ä½œä¸ºè„šæœ¬è¿è¡Œæ—¶æ‰§è¡Œ `main()`
- è¢«å¯¼å…¥æ—¶ä¸æ‰§è¡Œ

---

### åä¸‰ã€æ³¨é‡Š

#### 29. **å•è¡Œæ³¨é‡Š**
```30:30:glm6.py
# ä½¿ç”¨ç¤ºä¾‹
```
- `#` å•è¡Œæ³¨é‡Š
- ç”¨äºä»£ç è¯´æ˜

---

## çŸ¥è¯†ç‚¹åˆ†ç±»

### åŸºç¡€çº§åˆ«
1. å˜é‡èµ‹å€¼
2. å­—ç¬¦ä¸²ç±»å‹ä¸æ“ä½œ
3. print() å’Œ input() å‡½æ•°
4. å•è¡Œæ³¨é‡Š
5. åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ï¼‰

### ä¸­çº§çº§åˆ«
6. æ¨¡å—å¯¼å…¥ï¼ˆæ ‡å‡†å¯¼å…¥ã€from...importï¼‰
7. å‡½æ•°å®šä¹‰ä¸è°ƒç”¨
8. å­—å…¸å’Œåˆ—è¡¨
9. for å¾ªç¯
10. if æ¡ä»¶è¯­å¥
11. break è¯­å¥
12. åµŒå¥—æ•°æ®ç»“æ„è®¿é—®
13. f-string æ ¼å¼åŒ–
14. å­—ç¬¦ä¸²æ–¹æ³•
15. å…³é”®å­—å‚æ•°
16. return è¯­å¥
17. random.choice()
18. for-else è¯­å¥

### é«˜çº§çº§åˆ«
19. å¼‚å¸¸å¤„ç†ï¼ˆraiseï¼‰
20. é“¾å¼æ•°æ®ç»“æ„è®¿é—®
21. textwrap.dedent()
22. å¯¹è±¡æ–¹æ³•è°ƒç”¨
23. ç¨‹åºå…¥å£åˆ¤æ–­ï¼ˆ`__name__ == "__main__"`ï¼‰
24. API è°ƒç”¨ï¼ˆHTTP è¯·æ±‚ï¼‰
25. å¤æ‚æ•°æ®ç»“æ„æ“ä½œ
26. é€»è¾‘è¿ç®—ç¬¦ï¼ˆorï¼‰

---

## å®é™…åº”ç”¨åœºæ™¯

- çŒœè¯æ¸¸æˆï¼šä½¿ç”¨åˆ—è¡¨å­˜å‚¨å¤šä¸ªè¯æ±‡å’Œçº¿ç´¢
- API è°ƒç”¨ï¼šå°è£…å‡½æ•°è°ƒç”¨å¤–éƒ¨ API
- éšæœºé€‰æ‹©ï¼šä½¿ç”¨ `random.choice()` éšæœºé€‰æ‹©æ¸¸æˆç›®æ ‡
- ç”¨æˆ·äº¤äº’ï¼šä½¿ç”¨ `input()` å’Œ `print()` å®ç°äº¤äº’
- æ¡ä»¶æ§åˆ¶ï¼šä½¿ç”¨ `if` å’Œ `break` æ§åˆ¶æ¸¸æˆæµç¨‹
- å­—ç¬¦ä¸²å¤„ç†ï¼šä½¿ç”¨ f-string å’Œå­—ç¬¦ä¸²æ–¹æ³•å¤„ç†æ–‡æœ¬

è¿™äº›çŸ¥è¯†ç‚¹è¦†ç›–äº† Python ä»åŸºç¡€åˆ°ä¸­çº§çš„æ ¸å¿ƒå†…å®¹ï¼Œé€‚åˆå®é™…é¡¹ç›®å¼€å‘ã€‚